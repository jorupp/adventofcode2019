using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading;
using AoC.GraphSolver;

namespace AoC.Year2020.Day20
{
    public class Part2 : BasePart
    {
        protected void RunScenario(string title, string input)
        {
            RunScenario(title, () =>
            {
                var tiles = input.Replace("\r\n", "\n").Split("\n\n");
                var tileData = new Dictionary<int, char[][]>();
                foreach (var tile in tiles)
                {
                    var lines = tile.Split("\n");
                    var tileId = int.Parse(lines[0].Substring(5, 4));
                    var data = lines.Skip(1).Select(i => i.ToArray()).ToArray();
                    tileData.Add(tileId, data);
                }

                var patterns = tileData.ToDictionary(i => i.Key, i => GenerateEdgePatterns(i.Value));

                var corners = new List<int>();
                var partners = new Dictionary<int, int[]>();

                foreach (var tile1 in tileData.Keys)
                {
                    //foreach (var dir1 in Enumerable.Range(0, 16))
                    {
                        var p1 = patterns[tile1][0];
                        var matches = new List<int>();

                        foreach (var tile2 in tileData.Keys)
                        {
                            if (tile1 == tile2)
                            {
                                continue;
                            }
                            foreach (var dir2 in Enumerable.Range(0, 16))
                            {
                                var p2 = patterns[tile2][dir2];

                                if (p1[0] == p2[2] || p1[1] == p2[3] || p1[2] == p2[0] || p1[3] == p2[1])
                                {
                                    matches.Add(tile2);
                                    break;
                                }
                            }
                        }

                        if (matches.Count <= 2)
                        {
                            Console.WriteLine(
                                $"{tile1} only has {matches.Count} partners: {string.Join(",", matches)}");
                            corners.Add(tile1);
                        }
                        else
                        {
                            Console.WriteLine($"   {tile1} has {matches.Count} partners");
                        }

                        partners[tile1] = matches.ToArray();
                    }
                }

                //return;



                var h = (int)Math.Sqrt(tileData.Count);
                var w = h;

                var solution = new RealSolver().Evaluate<MapNode, string, int>(new MapNode(corners.ToArray(), partners, patterns, (short)h, new List<(int, short)>()));
                Console.WriteLine($"Solution: {solution}");
                var placed = solution._placed;
                var parts = new[]
                {
                    placed[0],
                    placed[w - 1],
                    placed[(h - 1) * w - 1],
                    placed[h * w - 1],
                }.Select(i => (long)i.Item1).ToList();

                for (var y = 0; y < h; y++)
                {
                    for (var x = 0; x < w; x++)
                    {
                        Console.Write(placed[y * w + x].Item1);
                        Console.Write(" ");
                    }

                    Console.WriteLine();
                }
                Console.WriteLine();

                parts.ForEach(i => Console.WriteLine(i));

                Console.WriteLine(parts.Aggregate(1L, (a, b) => a * b));

                var tileSize = tileData.First().Value.Length;
                var map = Enumerable.Range(0, (tileSize - 2) * w).Select(y =>
                    Enumerable.Range(0, (tileSize - 2) * w).Select(x => ' ').ToArray()).ToArray();

                for (var i = 0; i < placed.Count; i++)
                {
                    var sx = (i % w) * (tileSize - 2) - 1;
                    var sy = (i / w) * (tileSize - 2) - 1;
                    var tile = placed[i];

                    //var originalImage = GetMapImage(tileData[tile.Item1], 0);
                    var tileMapImage = GetMapImage(tileData[tile.Item1], tile.Item2);
                    //Write($"Original {tile.Item1}", originalImage);
                    //Write($"Rotated {tile.Item1} to {tile.Item2}", tileMapImage);

                    for (var y = 1; y < tileSize - 1; y++)
                    {
                        var ty = sy + y;
                        for (var x = 1; x < tileSize - 1; x++)
                        {
                            var tx = sx + x;
                            //var tmap = map[ty][tx];
                            var smap = tileMapImage[y][x];
                            //if (tmap != ' ' && tmap != smap)
                            //{
                            //    Console.WriteLine($"Mismatch - '{tmap}' != '{smap}' @ {i} -> {x},{y} / {tx},{ty}");
                            //    map[ty][tx] = 'X';
                            //}
                            //else
                            //{
                                map[ty][tx] = smap;
                            //}
                        }
                    }
                }

                Write("map", map);
                //map = RemoveBorder(map);
                //Write("border free map", map);

                var count = FindMaxMonsters(map);
                //var map12 = GetMapImage(map, 7);
                //Write("map12", map12);
                //var count = FindMonsters(map12);

                // 9 
                // 144

                // 0 = current
                // 1 = rotate 90 counterclockwise
                // 2 = rotate 180
                // 3 = rotate 270
                // 4 = h flip
                // 8 = v flip
                // 16 orientations total
                //  need to store top/bottom/left/right pattern for each
                // tiles are 10x10

                Console.WriteLine(count);
            });
        }

        private int FindMaxMonsters(char[][] map)
        {
            return Enumerable.Range(0, 16).Max(i =>
            {
                Console.WriteLine($"Searching rotation {i}");
                return FindMonsters(GetMapImage(map, i));
            });
        }

        private char[][] RemoveBorder(char[][] input)
        {
            return Enumerable.Range(0, input.Length - 2)
                .Select(r => Enumerable.Range(0, input.Length - 2).Select(c => input[r + 1][c + 1]).ToArray()).ToArray();
        }

        private int FindMonsters(char[][] map)
        {
            // clone
            map = map.Select(i => i.ToArray()).ToArray();
            var monster = @"                  # 
#    ##    ##    ###
 #  #  #  #  #  #   ".Replace("\r\n", "\n").Split("\n").Select(i => i.ToArray()).ToArray();

            //Write("monster", monster);


            var monsterStart = new List<(int, int)>();

            for (var sy = 0; sy < map.Length - monster.Length; sy++)
            {
                for (var sx = 0; sx < map.Length - monster[0].Length; sx++)
                {
                    for (var y = 0; y < monster.Length; y++)
                    {
                        for (var x = 0; x < monster[0].Length; x++)
                        {
                            if (monster[y][x] == '#')
                            {
                                //Console.WriteLine($"Checking {sx},{sy} @ {x},{y}: {map[sy + y][sx + x]} =?= {monster[y][x]} - {sy + y},{sx + x}");
                                if (map[sy + y][sx + x] != '#')
                                {
                                    //Console.WriteLine($"No monster at {sx},{sy} @ {x},{y}: {map[sy + y][sx + x]} != {monster[y][x]}");
                                    goto nextOne;
                                }
                            }
                        }
                    }

                    //Console.WriteLine("Found monster");
                    monsterStart.Add((sy, sx));

                    nextOne:
                    continue;

                }
            }

            // draw the monster

            foreach (var m in monsterStart)
            {
                var sy = m.Item1;
                var sx = m.Item2;

                for (var y = 0; y < monster.Length; y++)
                {
                    for (var x = 0; x < monster[0].Length; x++)
                    {
                        if (monster[y][x] == '#')
                        {
                            map[sy + y][sx + x] = 'O';
                        }
                    }
                }
            }

            if (monsterStart.Count == 0)
            {
                return 0;
            }

            Write($"With {monsterStart.Count} monsters:", map);

            return map.Sum(i => i.Count(ii => ii == '#'));
        }

        private void Write(string label, char[][] map)
        {
            Console.WriteLine(label);
            for (var y = 0; y < map.Length; y++)
            {
                for (var x = 0; x < map[y].Length; x++)
                {
                    Console.Write(map[y][x]);
                }
                Console.WriteLine();
            }
        }

        private class MapNode : Node<MapNode, string, int>
        {
            private readonly int[] _corners;
            private Dictionary<int, short[][]> _tiles;
            public List<(int, short)> _placed;
            private short _size;
            private Dictionary<int, int[]> _partners;

            public MapNode(int[] corners, Dictionary<int, int[]> partners, Dictionary<int, short[][]> tiles, short size,
                List<(int, short)> placed)
            {
                _corners = corners;
                _tiles = tiles;
                _size = size;
                _placed = placed;
                _partners = partners;
            }

            public override IEnumerable<MapNode> GetAdjacent()
            {
                var remaining = _tiles.Keys.Except(_placed.Select(i => i.Item1)).ToList();
                if (_placed.Count == 0 || _placed.Count == _size - 1 || _placed.Count == (_size - 1) * _size ||
                    _placed.Count == _size * _size - 1)
                {
                    remaining = remaining.Intersect(_corners).ToList();
                }
                var directions = Enumerable.Range(0, 16).Select(i => (short)i).ToList();
                //if (_placed.Count == 0)
                //{
                //    directions = new List<short>() { 8 };
                //    remaining = new List<int>() { 1951 };
                //}

                if (_placed.Count > 0)
                {
                    var x = (_placed.Count) % _size;
                    var y = (_placed.Count) / _size;

                    if (x > 0)
                    {
                        remaining = remaining.Intersect(_partners[_placed[_placed.Count - 1].Item1]).ToList();
                    }
                    if (y > 0)
                    {
                        remaining = remaining.Intersect(_partners[_placed[_placed.Count - _size].Item1]).ToList();
                    }
                }


                foreach (var tile in remaining)
                {
                    foreach (var dir in directions)
                    {
                        yield return new MapNode(_corners, _partners, _tiles, _size, _placed.Append((tile, dir)).ToList());
                    }
                }
            }

            public override bool IsValid
            {
                get
                {
                    if (_placed.Count == 0)
                    {
                        return true;
                    }

                    var x = (_placed.Count - 1) % _size;
                    var y = (_placed.Count - 1) / _size;

                    //Console.WriteLine($"Checking {this.Description}");

                    if (x > 0)
                    {
                        // check left
                        if (!AreMatch(_placed.Count - 2, 1, _placed.Count - 1, 3))
                        {
                            return false;
                        }
                    }
                    if (y > 0)
                    {
                        // check left
                        if (!AreMatch(_placed.Count - 1 - _size, 2, _placed.Count - 1, 0))
                        {
                            return false;
                        }
                    }

                    return true;
                }
            }


            public override bool IsComplete => _placed.Count == _size * _size;

            public override int CurrentCost => _placed.Count;
            public override int EstimatedCost => ((_size * _size) - _placed.Count) * 2 + _placed.Count;
            protected override string GetKey()
            {
                return string.Join(",", _placed.Select(i => $"{i.Item1}-{i.Item2}"));
            }

            public override string Description => GetKey();

            private bool AreMatch(int index1, short side1, int index2, short side2)
            {
                var tile1 = _placed[index1];
                var tile2 = _placed[index2];
                return _tiles[tile1.Item1][tile1.Item2][side1] == _tiles[tile2.Item1][tile2.Item2][side2];
            }

        }
        private short[][] GenerateEdgePatterns(char[][] input)
        {
            // TRBL
            var edges = new[]
            {
                input[0],
                input.Select(i => i.Last()).ToArray(),
                input.Last(),
                input.Select(i => i[0]).ToArray(),
            };

            var output = new List<char[][]>();
            output.Add(edges);
            output.Add(Rotate(output.Last()));
            output.Add(Rotate(output.Last()));
            output.Add(Rotate(output.Last()));
            output.AddRange(output.Select(HFlip).ToList());
            output.AddRange(output.Select(VFlip).ToList());

            return output.Select(i => i.Select(GetPattern).ToArray()).ToArray();
        }

        private char[][] GetMapImage(char[][] input, int change)
        {
            if (change == 0)
            {
                return input;
            }

            var size = input.Length;
            if (input.Any(i => i.Length != size))
            {
                throw new ArgumentException($"{size}");
            }

            while (change % 4 > 0)
            {
                input = Enumerable.Range(0, size)
                    .Select(
                        r => Enumerable.Range(0, size)
                            .Select(
                                c => input[c][size - r - 1]).ToArray()
                    ).ToArray();
                //Console.WriteLine($"Rotated {change}");
                change -= 1;
            }


            if ((change & 4) == 4)
            {
                input = Enumerable.Range(0, size)
                    .Select(
                        r => Enumerable.Range(0, size)
                            .Select(
                                c => input[r][size - c - 1]).ToArray()
                    ).ToArray();
                //Console.WriteLine($"H Fliped {change}");
                change -= 4;
            }

            if ((change & 8) == 8)
            {
                input = Enumerable.Range(0, size)
                    .Select(
                        r => Enumerable.Range(0, size)
                            .Select(
                                c => input[size - r - 1][c]).ToArray()
                    ).ToArray();
                //Console.WriteLine($"V Fliped {change}");
                change -= 8;
            }

            if (change != 0)
            {
                throw new NotImplementedException(change.ToString());
            }

            return input;
        }

        private char[][] Rotate(char[][] input)
        {
            return new[]
            {
                input[1],
                input[2].Reverse().ToArray(),
                input[3],
                input[0].Reverse().ToArray(),
            };
        }

        private char[][] HFlip(char[][] input)
        {
            return new[]
            {
                input[0].Reverse().ToArray(),
                input[3],
                input[2].Reverse().ToArray(),
                input[1],
            };
        }

        private char[][] VFlip(char[][] input)
        {
            return new[]
            {
                input[2],
                input[1].Reverse().ToArray(),
                input[0],
                input[3].Reverse().ToArray(),
            };
        }

        // patterns are LSB
        private short GetPattern(char[] input)
        {
            return (short)input.Select((i, ix) => (i == '#' ? 1 : 0) << ix).Sum();
        }



        public override void Run()
        {
            RunScenario("initial", @"Tile 2311:
..##.#..#.
##..#.....
#...##..#.
####.#...#
##.##.###.
##...#.###
.#.#.#..##
..#....#..
###...#.#.
..###..###

Tile 1951:
#.##...##.
#.####...#
.....#..##
#...######
.##.#....#
.###.#####
###.##.##.
.###....#.
..#.#..#.#
#...##.#..

Tile 1171:
####...##.
#..##.#..#
##.#..#.#.
.###.####.
..###.####
.##....##.
.#...####.
#.##.####.
####..#...
.....##...

Tile 1427:
###.##.#..
.#..#.##..
.#.##.#..#
#.#.#.##.#
....#...##
...##..##.
...#.#####
.#.####.#.
..#..###.#
..##.#..#.

Tile 1489:
##.#.#....
..##...#..
.##..##...
..#...#...
#####...#.
#..#.#.#.#
...#.#.#..
##.#...##.
..##.##.##
###.##.#..

Tile 2473:
#....####.
#..#.##...
#.##..#...
######.#.#
.#...#.#.#
.#########
.###.#..#.
########.#
##...##.#.
..###.#.#.

Tile 2971:
..#.#....#
#...###...
#.#.###...
##.##..#..
.#####..##
.#..####.#
#..#.#..#.
..####.###
..#.#.###.
...#.#.#.#

Tile 2729:
...#.#.#.#
####.#....
..#.#.....
....#..#.#
.##..##.#.
.#.####...
####.#.#..
##.####...
##..#.##..
#.##...##.

Tile 3079:
#.#.#####.
.#..######
..#.......
######....
####.#..#.
.#...#.##.
#.#####.##
..#.###...
..#.......
..#.###...");
            //return;
            RunScenario("part1", @"Tile 3187:
.........#
....##...#
##..#.#..#
#.##....##
..#.##...#
##.#..#.#.
#.##.....#
####......
...#..#..#
.##..##.#.

Tile 1223:
###.#..###
#......#.#
........##
..#.....##
##.......#
#........#
#..#.#...#
..#.##....
####.....#
.##..##..#

Tile 1913:
..#.......
##........
##.#.#..##
#..#......
###.#....#
.....##.#.
.......###
.##......#
#.....##..
#.#.#.###.

Tile 1301:
#...#..#.#
#..#...#..
#........#
.#..#....#
.#.#.##.#.
#....##.##
#...#....#
#.##....##
.###....#.
.#.#####..

Tile 3943:
..#.#.#..#
.#..#....#
#.....###.
#..#...#..
....#.##.#
.#........
#..#...#.#
#..#.#..##
....#...#.
#.####....

Tile 3023:
#..#....##
##..#.##.#
#.##.#...#
....##...#
.##..##..#
......#...
##......##
#..#..#...
##.#.....#
.#..#....#

Tile 3299:
#...#....#
.####.#..#
.........#
.#.....#..
#...#.##.#
..#.#..#.#
##.##....#
#..#.#...#
##........
.#.#.#.###

Tile 3677:
..#.#..#.#
#.#..#...#
#..#.#...#
#...#.##..
#..#......
#.#..#....
#...#..#..
#....##..#
..#..#.#..
#.####.#..

Tile 2803:
.#.#..####
#.#.#....#
#.......##
..#..##.##
#...#.....
##.#.....#
..#..#..##
...#.#.#..
#...#.###.
####.##.##

Tile 3343:
###.##..##
...#.#...#
#....#..#.
#...#....#
..#.#.....
.######.##
#.###.####
..##...##.
#.##......
...#..#.#.

Tile 1987:
.......##.
.#.....#..
#....###..
###.##....
.#...#...#
#.#..###.#
......#..#
...##.....
...##....#
#...#####.

Tile 1609:
...#.##.##
......#...
..#..#.#.#
...##.....
###.####.#
#......###
#.....##..
.##.#..#..
.##...#...
#.###...##

Tile 2221:
###.######
.##......#
##...#...#
..........
....#.#..#
#..#.....#
##..##...#
##..##....
.#.....#..
..########

Tile 2297:
.###..##.#
#..###....
..#..#..##
....######
##.......#
.......#.#
#.....#..#
###....#.#
#....##..#
....##.#..

Tile 2269:
##.....#..
.###..###.
#..##.....
....#.....
#..#...#.#
#....#..#.
#...###.##
.........#
....#.....
##.....#.#

Tile 2287:
#########.
##...#.###
#..#.#....
..##..####
....#.....
#....#.#.#
......#..#
#......#..
##..##....
##.......#

Tile 2399:
#.#.#..###
....#.....
#....##..#
##..#....#
#.#.#.....
.#...#..#.
#.#...#..#
.....##..#
#...##...#
#..##.##.#

Tile 1423:
##...#.#..
#.#...#.#.
.###..#..#
.........#
#...#...#.
#....##.##
#......#..
##..##...#
.#......##
...#.###.#

Tile 2621:
###.....#.
..#....#..
......#...
##.......#
.#.#..##..
#.#.##...#
#...#..#.#
#..###.#.#
###.......
..#.......

Tile 2003:
..#..#####
#.#.....#.
#..#.#...#
.#....#...
#.#.##.##.
##.#..##.#
.####..#.#
#.#...#..#
..####.#.#
..#..###.#

Tile 3889:
.#.##.#.##
.........#
######..##
...#...#..
#.....#..#
....#....#
#........#
...#.#.#.#
#..##..#..
..##..#...

Tile 1667:
#...####.#
#######..#
#.........
........##
.....##...
#...###..#
...#.....#
#..#....#.
.#.#.##..#
..#.###.#.

Tile 1877:
...#......
.#.#.#..#.
.....##..#
..........
...#.#....
#.##....##
#.#..##...
#..##..#..
#.........
##..#...##

Tile 2657:
#.#..####.
.....#...#
........#.
#.#......#
#..##.....
#........#
...##.#...
#....#.#..
.......#.#
########..

Tile 1669:
.###.####.
......###.
.#.##...##
..##...#..
##......##
.#........
###..#.###
.##...#.#.
....###.##
.####....#

Tile 2843:
#...#.#.##
.#.....#..
##.#....##
##.#..####
##........
..#.....##
.#.#......
##..#.#...
.#.#.....#
.#.#....##

Tile 2243:
..#....##.
.#.......#
......#..#
##......#.
#.##.....#
........#.
#..#.#...#
##..#..#..
...#...#.#
....####.#

Tile 1543:
..#..##...
..##..##.#
...#......
#.......##
......#.##
.#...#....
#.##....##
##..##.#.#
#.###....#
######.#.#

Tile 1777:
##.##..###
#.#...##..
........##
##.#......
.#....##..
#........#
......#...
#.........
.........#
#..###....

Tile 2161:
########.#
....#.....
####.#....
#.####....
..###..#..
.#..#....#
...#####..
#....#....
......#..#
######.#.#

Tile 3167:
.#.....##.
#..#.....#
...###..##
#.#.......
#.###.....
.#......#.
.##.##.#.#
.#.#..##..
..#...#.##
##.#..#.#.

Tile 1279:
#.....#..#
#...###.#.
##..###.#.
..#....#.#
#..#......
.#.....#.#
....#...#.
#.......#.
#.........
....###.##

Tile 2711:
##.###..##
.......###
#...#..###
#.........
#####.#...
#..#.###..
......#...
##.......#
....#....#
..####..#.

Tile 1087:
...#.##...
#....#..##
.....##.##
.#...#...#
.##..#..##
#...#....#
..#.......
##........
#.#.###...
##.##..###

Tile 3947:
.##...###.
##......#.
.#........
........##
........##
#..###...#
##.......#
#....##..#
#........#
#.##..#..#

Tile 1571:
#######..#
..#.#...#.
.........#
..#......#
.........#
#.......##
...#..##.#
.#..#.....
#..#.#....
#.#....###

Tile 2521:
..#.#.####
#........#
..........
..#...#...
....##...#
...#...#..
#.#.#...##
#.........
.#...#.##.
##.#####.#

Tile 3533:
...#.#.#.#
..#.......
.........#
...#......
##..#.#...
...#..#.##
.#...#.#.#
..#..###.#
###...#.##
#.#.......

Tile 2339:
#.#####...
..##......
#...##...#
#.#.#.....
#......##.
#...#...#.
......#.##
....##..##
..#.#..###
##..##...#

Tile 1493:
###..####.
..##.....#
.........#
..#.#...##
..#......#
..##....##
.#..##.##.
.........#
##.#.#...#
#.#..#.#.#

Tile 1637:
###.##.#.#
.....#....
#....##..#
#.....#...
..###.##..
#.#.......
##.#...##.
....#....#
#...#.##..
..#..####.

Tile 2153:
.#.##.#...
.....#...#
......#...
...#.#...#
#.#..##...
...#..#...
#.##.#..#.
.#.....#..
.......#.#
###...#.#.

Tile 1129:
..#.###...
#.####..##
#......#..
###.......
##......#.
#.#..#..##
#..##...##
.#......#.
.#........
#######..#

Tile 3581:
#...##.##.
#####..#..
#.##.#####
.....#....
#.........
.....#...#
.#........
#........#
##...#.#.#
..##..#...

Tile 1303:
####.##...
#...##....
#.##......
#.....#...
#....##...
####.#.###
#.#.#.#..#
#..#....##
#.#....#..
.#.##.....

Tile 3209:
##..##.###
...#.##...
##..##.#.#
..#.....#.
#.###...##
##.#.#....
###......#
....##....
#........#
.###.#..#.

Tile 3613:
##..####..
.#...#...#
#.##......
...#......
#.....#.#.
##.#.##...
......#.##
#.........
#.#...#...
###.#.....

Tile 3833:
......###.
#.#......#
#..#......
.#.#..#...
#.#.#....#
.....#....
#.....#...
.........#
##....###.
....#..##.

Tile 2089:
.#..###.##
##.##...#.
##..##..##
.#.#..#...
.#....#...
##.....#.#
...#.....#
.#..#....#
##..##...#
##..#.#.##

Tile 1553:
..#.##....
#..##...#.
#.#..#...#
.##..#...#
##..###...
##.#.#....
#..#.#.###
.........#
......#..#
#.#.#....#

Tile 2213:
#####....#
..###..#..
...#......
.........#
.#.###....
#.........
.....##.##
###......#
#...#####.
.##.##..##

Tile 3347:
..#..#####
#.##...#..
##.#..####
...###..#.
#.##......
.#.##..#..
#.##.#..#.
###...##..
#.#..#.#.#
#.#...##..

Tile 3203:
#.####.#.#
#......#.#
#..#...#.#
.#........
#......#..
#.###...#.
........##
..##...#.#
..........
#...#..##.

Tile 1811:
.##.####.#
.#......##
.......#.#
#...##.##.
#.......#.
#.#.#.####
.#.......#
....#...#.
......###.
#...#..###

Tile 1531:
##...#.#.#
.##......#
#........#
#...#.....
#...###..#
...#.#....
#.......#.
.#..###.#.
.....####.
##.#.####.

Tile 3191:
##..###.##
#.###...#.
..#....#.#
##.#...###
..#.......
.....#....
#......#.#
.........#
..##.#...#
...##.....

Tile 3259:
...###..##
#...#....#
#.....#.#.
.#...#...#
.........#
.........#
...#.....#
#.....##.#
..#...#..#
...##.####

Tile 1579:
.#.##.#..#
.#.#.#....
...#.....#
#..#.....#
....#....#
#.#..#.###
#.#.#.....
##.......#
##.....##.
.###.....#

Tile 1861:
...##.#...
...#.....#
#.#.####..
......#..#
#....#...#
..#.#.##..
.#........
.##.#.#..#
##.....#..
...###.###

Tile 2857:
###.#.##..
.......#.#
#...#.....
##.#.....#
.#....#.#.
#.....#.##
#......#.#
#.....#..#
#.#.#....#
.#..#....#

Tile 3853:
...###...#
#.#.##..##
#.......##
..####..##
.#........
..........
...##.....
....#....#
#........#
.#.##..###

Tile 3917:
#.#.###.##
..........
#..#.#....
#.#....#.#
##..#...##
##.....#..
#.#....#..
.#.....#..
..#.....#.
######.###

Tile 1999:
.######...
.##.#....#
..#.......
.......#.#
.........#
........#.
#..#.#####
##....##..
#.#.....#.
.##.##....

Tile 3719:
..#..##...
##.###....
####..#.#.
#.....#...
#..##.#..#
....#.###.
.##..#...#
......#..#
.#.#....#.
#....###.#

Tile 3491:
....#.##..
#..#.#...#
.#..###..#
#...#.....
#..#...###
..#.#.....
##.#.....#
..##.###.#
#.##.....#
..#.#.####

Tile 3499:
#.##.#...#
#...#.####
.....#....
#.....#.##
.#........
.#.#...#..
.##.#.##..
....#....#
##...#..#.
#.#..##...

Tile 2311:
..#.#...##
#.#.......
.........#
#.....#...
#..#...#..
..##......
....#...#.
#..##...##
#.........
.#...###..

Tile 1459:
####.#...#
..#.####.#
.#.......#
..#.#....#
..........
#.....#.#.
#.....#...
###.#....#
..##..#...
....#..##.

Tile 1447:
.##.##....
.##....#..
######.#.#
..........
#.........
#...#.##.#
#...##...#
#.......##
....#.....
.##.#..#..

Tile 2579:
##...##...
#..#.#..##
...##.#..#
#.#......#
.#....#...
.##......#
#..#..#..#
..#...#.##
#..##....#
.##..###.#

Tile 2531:
#...#..###
.#..#.###.
#......##.
.##..#.#..
.....#..##
.....#.#..
#.#....#..
....#...#.
.......#..
.#.##..#.#

Tile 1019:
....####..
#....#.#..
#.#.#....#
.#...#...#
..#.#....#
#....##...
..#.###..#
#..#..#..#
..#.#.....
..##.#..#.

Tile 1151:
#..#.#.#..
#.....#...
.#..#.#.##
..###....#
..##..#.#.
.#..##....
#...#..##.
..#.###.#.
.#...#....
..###....#

Tile 3767:
.#...###.#
...#.##...
#....###..
...#..#..#
#...##....
##...#....
.##...###.
#...####..
##...###..
..##.#....

Tile 1871:
......#..#
#.#..#....
.........#
......##.#
#....#....
##..#.##.#
#.....#.##
#..#.....#
.#.#..#...
##.##...#.

Tile 2953:
#..##..#.#
#...#.....
.##.......
.#..#.....
##........
#.#..#.#.#
...##....#
...#....##
..#.#.....
.##...#.##

Tile 1153:
.#..######
.#.#.....#
#.....#...
##...#.##.
#...#....#
.#..#.#.#.
##...##...
.#.#.....#
..##..#..#
.......##.

Tile 3359:
#.#####.##
#...#....#
#..#...#..
.#.##....#
###.....##
.#..#.#..#
#........#
.##...#...
#.........
...#...#..

Tile 3257:
...#.####.
##.##....#
.......#.#
#........#
#...#....#
#...#....#
.#...#..#.
#...#....#
###.....##
.....#####

Tile 2557:
##..######
.........#
..##...#.#
#....#..##
...#.#..#.
.#.....##.
...##...##
..#.#...##
....#.#...
#.##...###

Tile 2851:
.#....####
#......#.#
#...#..#.#
#......#..
.#...#....
#.......#.
........#.
#......#.#
...#.....#
......##..

Tile 1103:
#...#.....
#..#..#...
...##.#..#
....###.##
....#..##.
.#..###...
##.....###
...#...#.#
......##.#
.#.#.#.##.

Tile 1801:
##.#...##.
....##..#.
#.......#.
.##...##..
......##..
.#...##..#
.#..#..#..
...#.#..##
##.....#..
#.#.#.#...

Tile 2731:
#.#.#.#..#
#.#....###
#####..#..
#...#.....
#.#...####
#.........
.#.....#..
..#.......
#......#.#
..#.#.##..

Tile 2111:
..##...#..
#...#..###
......##.#
..#.......
#........#
#.......#.
#...##...#
#....#...#
..#...#...
.#....###.

Tile 1613:
..###..#..
#...##...#
#.........
#...#.#..#
#.###...#.
#.##..#...
#......##.
##.#......
..#...#..#
.##...###.

Tile 3739:
#.#.#.#..#
###.#....#
..#..##.#.
.#..#...#.
#.####....
.#......#.
#....#...#
.........#
##..#....#
#...#.#.##

Tile 1297:
.##..#.##.
#.#...#.##
#...##..##
.#..##.###
#...#.....
.##.#....#
........#.
.####..#..
..#.....#.
###..##..#

Tile 2029:
#.....#.##
#.#..#...#
#.####..#.
....#.#.#.
#...#.#...
#......###
......##..
.........#
......##.#
#.###.#..#

Tile 1093:
#.#..#..##
##......#.
#.........
#.........
....#....#
#....###.#
#.#.....##
..#.......
.#.#....#.
#.###.#.##

Tile 2357:
#..#.##..#
..#.......
...#..#..#
.#.....##.
##.#...#.#
#.#.....#.
##.......#
#.#..##...
#....#..##
#.###..###

Tile 1231:
.######...
#..##.....
#........#
#........#
..........
....#...#.
#.##.#..##
##..#.##..
......#.##
.#...##...

Tile 2671:
####..###.
..#.......
...#..#...
#.#.......
.#.#..#...
##.##....#
#....##.#.
#...#....#
#...#.....
..#..##.#.

Tile 3137:
.#..##...#
...#.#..##
#...#....#
#....#...#
.##..##.#.
#.#....#..
#.#.....##
#..##...##
#.....##..
#.#.###.#.

Tile 1229:
...#######
#.#...#..#
..#.....#.
#.##.##.#.
.##.#..##.
....####..
..##..#...
#...#.....
#..###.#..
#.###..##.

Tile 1979:
#..#....##
#....#...#
.#.#....##
.......#.#
..#..##..#
#.#...##.#
...#..#..#
#....#..##
##......#.
.######..#

Tile 2341:
.#.##.....
###......#
........#.
##...#..#.
#...#...#.
#...##.#..
...#..#..#
..##.....#
#...##.#.#
...#..#.##

Tile 1373:
.#####..##
#.#.....#.
........##
.........#
....###.##
#.##.##..#
###.#.##..
..#.....#.
.........#
#.#.###.##

Tile 1483:
#.#..#..##
.##.###...
#.........
#..#......
#...##....
.##.....#.
.#...#.#..
..#......#
..#.#.#...
.##.######

Tile 3109:
.##.###.#.
....###.#.
#...#.....
#.......##
.#.#..####
..#..#####
##...#.#..
..##.....#
#..#..####
##..#.#...

Tile 3449:
##.###..#.
....#.#...
#...#.....
....##..#.
.##.#.#.##
.##..###.#
....##...#
...###....
#....#...#
.#...#.#..

Tile 2969:
##..#.##..
.#..###..#
...###.#.#
..#....#..
#####.....
.#.##....#
.......#.#
.........#
.#......#.
......#.#.

Tile 3877:
##..#...##
....#....#
#..##.....
.....#....
#......#..
.#...#...#
......##.#
##.....##.
..#..#...#
##..###.#.

Tile 3539:
..#...##..
........#.
..#.#....#
##.#.##..#
#...#..#..
..#.......
.#...##...
...#.##.#.
#..##..##.
......#.#.

Tile 3547:
####..#..#
........##
##.#...#.#
...##...##
.#..###..#
##.###..#.
.#..##..##
#....##...
......#...
.##.###..#

Tile 3863:
..#.##.###
....#.#..#
..#...#..#
##.#.#..##
.##.......
#.#...##..
#.#...##.#
.#.#....##
#.#...#.##
##..##....

Tile 2437:
#.##.#####
.#....#..#
#....#....
.....##..#
#..#.#..#.
......#...
..##.#.#..
..##......
.#..##...#
####.#####

Tile 2267:
#..###..##
.#........
###.#....#
....#.....
#.....#..#
..#.......
......####
.#........
#.#......#
...##.....

Tile 3671:
#.##.#####
..#..##...
..........
##.....#.#
.###......
###.....##
##..#....#
#....#....
##......##
###.#.#..#

Tile 3041:
#...######
.........#
.#....####
#.##......
.##...#...
##..#....#
.#.#...#.#
#..#.###..
##..#....#
##..#.###.

Tile 2467:
#####...#.
#.#.#.....
##........
##...#....
.......##.
##......#.
##.#..####
....##...#
####..#..#
#.#.#..###

Tile 3593:
..##.##..#
..........
.#.###..#.
......##..
..........
........#.
##...#.#.#
...##.#..#
...##....#
..##..#.##

Tile 3061:
####.##.#.
..##....#.
###..#...#
..........
.####...#.
..##..#...
...#......
##..#..##.
#.#...#..#
###.###..#

Tile 1409:
#.#.#...#.
#....#..##
......#...
..........
.#..##...#
###......#
#..#.#...#
###....#..
#.......##
#..##.#.#.

Tile 2207:
..#.##.###
#........#
.........#
..#.#...#.
#.##......
....##....
..#.#..##.
###.....#.
.###...#.#
#...#.##..

Tile 1069:
..#....###
#...#.....
.....#..#.
.###...#.#
..###....#
..........
#.....#..#
#.#..#..#.
#..##....#
...##...##

Tile 1187:
#...##..#.
#......#.#
#.......##
##.....###
.#...#.##.
##.#......
###.#...##
#.##...#..
#....#....
#.......#.

Tile 2549:
.###.....#
##.#.#..##
#...#..##.
##.......#
#.........
.#.#..#.##
..........
##...#...#
#....#...#
#####...##

Tile 2593:
#.#..##...
...##...##
.##..##.##
.#..#....#
....####.#
........#.
.###.....#
....##..##
#..#....##
.##..#.#..

Tile 1277:
.#.#...##.
..##.#.###
....#...##
......#.#.
..##.#.#.#
.....#..##
..#...##.#
....#..#.#
##..###...
#....#####

Tile 2251:
#..###..##
#....##...
###...##.#
.#.####.##
#.##....#.
.#...#....
#.......##
.#.#....#.
#.....#..#
###...##..

Tile 1061:
.#.#....##
#.........
.....#..##
...#..#...
..........
#..##.##.#
#...#...##
##.......#
..#.##....
#.#..#...#

Tile 3037:
#.....#.##
........#.
........#.
##..##..#.
.##.##....
##..#...#.
#....#.###
...#..#.#.
#.#####..#
...###.##.

Tile 3823:
.###..#...
#...#.....
....#.#...
#.#..###..
##.#..#.##
.####....#
.###.....#
.#...#...#
#..#####..
..###...#.

Tile 2087:
.#...#.###
.#.##..###
.....#...#
#...#.....
...#.#....
........##
........##
#..#..#..#
.#....##..
####...###

Tile 1321:
#.###.##.#
#...#.....
.##.#...##
#.....#..#
.#...#....
...##.....
#..##.....
#..#...##.
#........#
###.###.#.

Tile 1951:
###.####.#
#...#.....
#.#.#.###.
..##...#.#
#.#..#..#.
##.#.....#
#......#..
.#........
.#.......#
..##...#.#

Tile 3847:
.###.#..##
#..##..#..
..#....#..
#...#...##
#.........
.#...#....
.##.#...##
..#.#..###
...#..##.#
##.#.##..#

Tile 3851:
...##.##..
....#..#.#
.###..#..#
..........
..........
#........#
##..#....#
#......#.#
.....#.#..
.###.#.#..

Tile 3407:
#####.#.##
.......#..
#.....#...
#...##....
........#.
...##.#.#.
.##....##.
#.....#...
....#.....
#..#..#...

Tile 1709:
....#.#..#
....##.###
#.....#..#
#......#.#
.......###
..........
#.#.#....#
..#...##.#
#..#...#.#
.##.#.##..

Tile 1097:
#.###.##.#
.........#
....##.#..
...#.#..##
..#.#....#
..#..##..#
#####....#
#.#..###..
....#.....
######.##.

Tile 3301:
.#..#..#..
.#........
#..#.#....
......#..#
#....#..##
#........#
#.....#.##
#....#...#
...#.#..#.
..####.###

Tile 3517:
#####.##..
#...##..##
.#..#.....
#...#....#
..#.#...##
####..##..
#.#..#..#.
.....#....
.....#.#.#
..#..####.

Tile 2137:
#...##.##.
..#...#.##
#..#.....#
##...###.#
.#.#...#.#
..##..#..#
..#......#
#.#####.##
#..#......
####......

Tile 3623:
#.##.##.#.
.#..#....#
#..##.##..
...##....#
###..#....
..##.#....
.....#.###
......#...
#.........
#...#..##.

Tile 1867:
#..#.##.##
..#..##...
#.##......
##...##..#
..#...##..
#.#.#....#
.........#
.##.##....
...##.....
##...###.#

Tile 1787:
.#..#.##..
...#......
....#..#..
##.#.#.#..
...##....#
...#......
###......#
..........
.......##.
####..#...

Tile 2591:
....###.##
#..#....#.
......#..#
#........#
.....#....
###.#....#
.....###..
###.......
......#..#
..#.#.#...

Tile 1607:
.#.#..####
#.....##..
#..#.....#
..###...##
.......###
#..##.....
...#......
#...#...#.
#.....#.#.
...#...#..

Tile 3271:
.#.###.###
#........#
.#........
####....#.
.......#..
#.....#..#
##.##.##..
.#........
#......#..
.#..####.#

Tile 2063:
#...##.#.#
##...##.#.
.##.##.#..
#..#...#.#
..#.#....#
.##...##..
.#.#.#....
#...#....#
.#........
..#.#.#.##

Tile 1289:
.#..##....
..#..##...
.#....#...
.......#.#
##..#...#.
...##...##
...##.....
.##.#....#
##.....#..
..#.###.#.

Tile 1213:
..#..##.#.
#.#..#.#..
#.........
#..#...#..
#...#...##
..#.......
...##.#...
.##.#.....
##.##....#
####.#.###");

        }
    }
}
